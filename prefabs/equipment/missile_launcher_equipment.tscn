[gd_scene load_steps=13 format=3 uid="uid://fdwr2k405h50"]

[ext_resource type="Script" path="res://scripts/equipment/equipment.gd" id="1_fn1ka"]
[ext_resource type="Script" path="res://scripts/entities/stats/stat_block_proxy.gd" id="2_jaoy0"]
[ext_resource type="Script" path="res://scripts/entities/stats/stat.gd" id="3_ck72q"]
[ext_resource type="Texture2D" uid="uid://nuxnb888liog" path="res://assets/art/equipment/missile_launcher.png" id="4_sphhu"]
[ext_resource type="Script" path="res://scripts/equipment/equipment_turret.gd" id="4_y0lf0"]
[ext_resource type="Script" path="res://scripts/entities/entity_tracker.gd" id="10_dbj3h"]
[ext_resource type="Script" path="res://scripts/equipment/range_collision_shape_2d.gd" id="11_sf78e"]
[ext_resource type="Script" path="res://scripts/equipment/shoot_types/shoot_missile.gd" id="12_khl2n"]
[ext_resource type="PackedScene" uid="uid://c8kosebxby1ve" path="res://prefabs/projectiles/missile.tscn" id="13_70f4j"]
[ext_resource type="PackedScene" uid="uid://dk8hihv2xvjs5" path="res://prefabs/projectiles/large_missile.tscn" id="14_61wtj"]
[ext_resource type="Script" path="res://scripts/entities/team.gd" id="15_c180v"]

[sub_resource type="CircleShape2D" id="CircleShape2D_ourt5"]
radius = 400.0

[node name="MissileLauncher" type="Node2D" node_paths=PackedStringArray("rotated_part")]
script = ExtResource("1_fn1ka")
cooldown = 5.0
rotated_part = NodePath("EquipmentTurret/TurretHead")

[node name="StatBlockProxy" type="Node" parent="."]
script = ExtResource("2_jaoy0")

[node name="Reload" type="Node" parent="StatBlockProxy"]
script = ExtResource("3_ck72q")
type = 4
base_amount = 50

[node name="Damage" type="Node" parent="StatBlockProxy"]
script = ExtResource("3_ck72q")
type = 5
base_amount = 50

[node name="Range" type="Node" parent="StatBlockProxy"]
script = ExtResource("3_ck72q")
type = 13
base_amount = 50

[node name="EquipmentTurret" type="Node2D" parent="." node_paths=PackedStringArray("turret_head", "turret_muzzle", "entity_tracker", "team")]
script = ExtResource("4_y0lf0")
turret_head = NodePath("TurretHead")
turret_muzzle = NodePath("TurretHead/TurretMuzzle")
entity_tracker = NodePath("EntityTracker")
team = NodePath("../Team")

[node name="TurretHead" type="Node2D" parent="EquipmentTurret"]

[node name="Sprite2D" type="Sprite2D" parent="EquipmentTurret/TurretHead"]
position = Vector2(0, 0.05848)
texture = ExtResource("4_sphhu")

[node name="TurretMuzzle" type="Node2D" parent="EquipmentTurret/TurretHead"]

[node name="EntityTracker" type="Area2D" parent="EquipmentTurret" node_paths=PackedStringArray("team")]
script = ExtResource("10_dbj3h")
mode = 2
team = NodePath("../../Team")

[node name="RangeCollisionShape2D" type="CollisionShape2D" parent="EquipmentTurret/EntityTracker" node_paths=PackedStringArray("range")]
shape = SubResource("CircleShape2D_ourt5")
debug_color = Color(0.701961, 0.690196, 0, 0.0705882)
script = ExtResource("11_sf78e")
range = NodePath("../../../StatBlockProxy/Range")

[node name="ShootMissile" type="Node" parent="." node_paths=PackedStringArray("muzzle", "team")]
script = ExtResource("12_khl2n")
missile_prefabs = Array[PackedScene]([ExtResource("13_70f4j"), ExtResource("14_61wtj")])
muzzle = NodePath("../EquipmentTurret/TurretHead/TurretMuzzle")
team = NodePath("../Team")
reload_duration = 0.5

[node name="Team" type="Node" parent="."]
script = ExtResource("15_c180v")

[connection signal="active_used" from="." to="EquipmentTurret" method="lock_to_direction" binds= [1.0]]
[connection signal="active_used" from="." to="ShootMissile" method="spawn_and_shoot_missile" binds= [1]]
[connection signal="on_shoot" from="EquipmentTurret" to="ShootMissile" method="shoot"]
